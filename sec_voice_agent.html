<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</title>
    
    <!-- Load Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* SEC Brand Colors */
        :root {
            --sec-blue: #004481; /* Deep Blue */
            --sec-orange: #F26724; /* Bright Orange */
            --shadow-color: rgba(0, 68, 129, 0.15);
        }

        /* Header */
        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 1rem 2rem;
            position: relative;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--sec-blue) 0%, #1E5BA8 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .logo-icon {
            width: 30px;
            height: 30px;
            border: 3px solid var(--sec-orange);
            border-radius: 50%;
            border-top-color: transparent;
            border-left-color: transparent;
        }

        .company-name {
            display: flex;
            flex-direction: column;
        }

        .company-name h1 {
            color: var(--sec-blue);
            font-size: 1.3rem;
            font-weight: 700;
        }

        .company-name p {
            color: var(--sec-orange);
            font-size: 0.9rem;
            margin-top: 2px;
        }

        .website-link {
            color: var(--sec-blue);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            transition: color 0.3s;
        }

        .website-link:hover {
            color: var(--sec-orange);
        }

        /* Main Container */
        .container {
            flex: 1;
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            width: 100%;
        }

        /* Card */
        .card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px var(--shadow-color);
            padding: 3rem 2rem;
            text-align: center;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card-header {
            margin-bottom: 2rem;
        }

        .badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--sec-blue) 0%, #1E5BA8 100%);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .main-title {
            color: #2C3E50;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .subtitle {
            color: #7F8C8D;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Voice Button Container */
        .voice-container {
            margin: 3rem 0;
            position: relative;
        }

        .pulse-ring {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(0, 68, 129, 0.1) 0%, rgba(242, 103, 36, 0.1) 100%);
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(0, 68, 129, 0.4);
            }
            70% {
                box-shadow: 0 0 0 30px rgba(0, 68, 129, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(0, 68, 129, 0);
            }
        }

        /* Status */
        .status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            color: #7F8C8D;
            font-size: 1rem;
            margin: 2rem 0;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: #95A5A6;
            border-radius: 50%;
        }

        .status.connecting .status-dot,
        .status.speaking .status-dot {
            background: var(--sec-orange);
            animation: blink 2s infinite;
        }

        .status.connected .status-dot {
             background: #27AE60;
             animation: none;
        }

        .status.error .status-dot {
            background: #e74c3c; /* Red for error */
            animation: none;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Action Button */
        .action-button {
            background: linear-gradient(135deg, var(--sec-blue) 0%, #1E5BA8 100%);
            color: white;
            border: none;
            padding: 1rem 3rem;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 20px var(--shadow-color);
            margin-bottom: 2rem;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 68, 129, 0.4);
        }

        .action-button:active {
            transform: translateY(0);
        }
        
        /* Disabled button state */
        .action-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Quick Actions */
        .quick-actions {
            border-top: 1px solid #E8EEF5;
            padding-top: 2rem;
            margin-top: 2rem;
        }

        .quick-actions-title {
            color: #7F8C8D;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .quick-action-card {
            background: linear-gradient(135deg, #F8F9FA 0%, #E8EEF5 100%);
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            text-align: right;
        }

        .quick-action-card:hover {
            transform: translateY(-3px);
            border-color: var(--sec-blue);
            box-shadow: 0 6px 20px rgba(0, 68, 129, 0.15);
        }

        .quick-action-title {
            color: #2C3E50;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .quick-action-desc {
            color: #7F8C8D;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        /* Footer */
        .footer {
            background: white;
            padding: 1.5rem 2rem;
            text-align: center;
            color: #7F8C8D;
            font-size: 0.9rem;
            border-top: 1px solid #E8EEF5;
            margin-top: 2rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .main-title {
                font-size: 1.8rem;
            }

            .subtitle {
                font-size: 1rem;
            }

            .card {
                padding: 2rem 1.5rem;
            }

            .quick-actions-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Hide the actual Vapi Widget visually, but keep it in DOM */
        vapi-widget {
            position: fixed;
            bottom: 10px;
            right: 10px;
            z-index: -1; /* Behind everything */
            opacity: 0;  /* Invisible */
            pointer-events: none; /* Cant be clicked directly */
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">
                    <div class="logo-icon"></div>
                </div>
                <div class="company-name">
                    <h1>Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</h1>
                    <p>Ù†Ø¹Ù…Ù„ Ø¨Ø¥ØªÙ‚Ø§Ù† Ù…Ù† Ø£Ø¬Ù„ÙƒÙ…</p>
                </div>
            </div>
            <a href="https://www.se.com.sa" class="website-link" target="_blank">www.se.com.sa</a>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <div class="card">
            <div class="card-header">
                <div class="badge">ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</div>
                <h2 class="main-title">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
                <p class="subtitle">
                    Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ - Ø§Ù„ÙÙˆØ§ØªÙŠØ±ØŒ Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹Ø§ØªØŒ ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„ÙÙ†ÙŠØ©
                </p>
            </div>

            <div class="voice-container">
                <div class="pulse-ring">
                    <svg width="100" height="100" viewBox="0 0 100 100" fill="none">
                        <circle cx="50" cy="50" r="40" fill="url(#gradient)" />
                        <path d="M50 30 C50 30 42 35 42 45 L42 55 C42 65 50 70 50 70 C50 70 58 65 58 55 L58 45 C58 35 50 30 50 30 Z" fill="white"/>
                        <rect x="47" y="70" width="6" height="10" fill="white"/>
                        <rect x="40" y="78" width="20" height="4" rx="2" fill="white"/>
                        <defs>
                            <linearGradient id="gradient" x1="0" y1="0" x2="100" y2="100">
                                <stop offset="0%" style="stop-color:var(--sec-blue);stop-opacity:1" />
                                <stop offset="100%" style="stop-color:var(--sec-orange);stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
            </div>

            <div class="status" id="status">
                <span class="status-dot"></span>
                <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...</span>
            </div>

            <button class="action-button" id="startButton" disabled>
                ğŸ™ï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
            </button>

            <div class="quick-actions">
                <div class="quick-actions-title">
                    âš¡ Ø¬Ø±Ø¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
                </div>
                <div class="quick-actions-grid">
                    <div class="quick-action-card" data-prompt="Ù„ÙŠØ´ ÙØ§ØªÙˆØ±ØªÙŠ Ø§Ø±ØªÙØ¹Øª Ù‡Ø§Ù„Ø´Ù‡Ø±ØŸ">
                        <div class="quick-action-title">Ù„ÙŠØ´ ÙØ§ØªÙˆØ±ØªÙŠ Ø§Ø±ØªÙØ¹Øª Ù‡Ø§Ù„Ø´Ù‡Ø±ØŸ</div>
                        <div class="quick-action-desc">Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ø±ØªÙØ§Ø¹ Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ§Ù„ÙØ§ØªÙˆØ±Ø©</div>
                    </div>
                    <div class="quick-action-card" data-prompt="Ø¹Ù†Ø¯ÙŠ Ø§Ù†Ù‚Ø·Ø§Ø¹ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø¨Ø§Ù„Ø¨ÙŠØª">
                        <div class="quick-action-title">Ø¹Ù†Ø¯ÙŠ Ø§Ù†Ù‚Ø·Ø§Ø¹ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø¨Ø§Ù„Ø¨ÙŠØª</div>
                        <div class="quick-action-desc">Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ ÙˆÙØªØ­ Ø¨Ù„Ø§Øº</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>Â© 2024 Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
    </div>

    <!-- Vapi Widget Code - Hidden via CSS but fully functional -->
    <vapi-widget
        id="vapiWidget"
        public-key="1f2432da-8fee-4c9e-af48-674fa145d001"
        assistant-id="e2a656f8-5bfc-4cb1-993d-9db82a69bd79"
        mode="voice"
        theme="dark"
        base-bg-color="#000000"
        accent-color="#F26724" 
        cta-button-color="#004481"
        cta-button-text-color="#ffffff"
        border-radius="large"
        size="full"
        position="bottom-right"
        start-button-text="Ø§Ø¨Ø¯Ø£"
        end-button-text="Ø¥Ù†Ù‡Ø§Ø¡"
        chat-first-message="Ø£Ù‡Ù„Ø§Ù‹ØŒ ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ"
        voice-show-transcript="true"
        consent-required="true"
        consent-title="Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…"
        consent-content="Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ 'Ø£ÙˆØ§ÙÙ‚'ØŒ ÙØ¥Ù†Ù†ÙŠ Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ ØªØ³Ø¬ÙŠÙ„ ÙˆØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©."
        consent-storage-key="vapi_widget_consent"
    ></vapi-widget>

    <!-- The Vapi Widget SDK loader -->
    <script src="https://unpkg.com/@vapi-ai/client-sdk-react/dist/embed/widget.umd.js" async type="text/javascript"></script>

    <script>
        // UI Elements
        const startButton = document.getElementById('startButton');
        const statusEl = document.getElementById('status');

        let isCallActive = false;
        let internalButton = null; // This will hold the actual button inside the Shadow DOM
        let isWidgetReady = false;

        // --- UI Update Functions ---
        function updateStatus(state) {
            statusEl.classList.remove('connected', 'connecting', 'speaking', 'error', 'idle');
            
            // Map states
            let text = 'ØºÙŠØ± Ù…ØªØµÙ„';
            let cls = 'idle';
            
            if (state === 'connecting') { text = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...'; cls = 'connecting'; }
            else if (state === 'connected') { text = 'Ù…ØªØµÙ„ - ØªØ­Ø¯Ø« Ø§Ù„Ø¢Ù†'; cls = 'connected'; }
            else if (state === 'speaking') { text = 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ ÙŠØªØ­Ø¯Ø«...'; cls = 'speaking'; }
            else if (state === 'error') { text = 'ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ / Ø§Ù„ØªÙ‡ÙŠØ¦Ø©.'; cls = 'error'; }
            
            statusEl.classList.add(cls);
            statusEl.innerHTML = `<span class="status-dot"></span><span>${text}</span>`;
        }

        function updateButton(active, loading = false) {
            if (loading) {
                startButton.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
                startButton.disabled = true;
                return;
            }
            
            if (active) {
                startButton.textContent = 'â¹ï¸ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©';
                startButton.style.background = 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)';
            } else {
                startButton.textContent = 'ğŸ™ï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©';
                startButton.style.background = 'linear-gradient(135deg, var(--sec-blue) 0%, #1E5BA8 100%)';
            }
            startButton.disabled = false;
        }

        // --- Shadow DOM Connector ---
        // This function hunts down the button INSIDE the widget's shadow DOM
        function findInternalButton() {
            const widget = document.querySelector('vapi-widget');
            if (!widget || !widget.shadowRoot) return null;
            
            // Vapi widget usually puts the main button inside the shadow root.
            // We look for a button element.
            const btn = widget.shadowRoot.querySelector('button');
            return btn;
        }

        // --- Initialization (Polling) ---
        function initializeConnector() {
            if (isWidgetReady) return;

            const btn = findInternalButton();
            
            if (btn) {
                // Found it!
                console.log("Successfully connected to Vapi Internal Button.");
                internalButton = btn;
                isWidgetReady = true;
                updateButton(false); // Enable our button
                updateStatus('idle');

                // Attach widget event listeners to sync UI
                const widget = document.querySelector('vapi-widget');
                widget.addEventListener('call-start', () => {
                    isCallActive = true;
                    updateButton(true);
                    updateStatus('connected');
                });
                widget.addEventListener('call-end', () => {
                    isCallActive = false;
                    updateButton(false);
                    updateStatus('idle');
                });
                widget.addEventListener('speech-start', () => updateStatus('speaking'));
                widget.addEventListener('speech-end', () => updateStatus('connected'));
                widget.addEventListener('error', () => updateStatus('error'));

            } else {
                // Keep looking...
                console.log("Waiting for Vapi Widget Shadow DOM...");
                setTimeout(initializeConnector, 200); 
            }
        }

        // --- Main Toggle Function ---
        function toggleCall(prompt = null) {
            if (!isWidgetReady || !internalButton) return;

            // If we are starting a call and have a prompt, we might want to inject it.
            // But with the Shadow DOM click method, we are just clicking the button.
            // The prompt injection via attribute works if done BEFORE the call starts.
            if (!isCallActive && prompt) {
                const widget = document.querySelector('vapi-widget');
                const systemPrompt = `Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡. Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø«Ù… Ø¹Ø§Ù„Ø¬ Ø§Ø³ØªÙØ³Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙÙˆØ±ÙŠ ÙˆÙ‡Ùˆ: "${prompt}"`;
                widget.setAttribute('chat-first-message', systemPrompt);
            }

            // SIMULATE CLICK on the hidden internal button
            internalButton.click();
            
            // Reset prompt after a delay if we used one
            if (!isCallActive && prompt) {
                setTimeout(() => {
                    const widget = document.querySelector('vapi-widget');
                    widget.setAttribute('chat-first-message', "Ø£Ù‡Ù„Ø§Ù‹ØŒ ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ");
                }, 2000);
            }
        }

        // --- Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            // Link main button
            startButton.addEventListener('click', () => toggleCall());

            // Link quick action cards
            document.querySelectorAll('.quick-action-card').forEach(card => {
                card.addEventListener('click', function() {
                    const prompt = this.getAttribute('data-prompt');
                    toggleCall(prompt);
                });
            });

            // Start hunting for the widget
            setTimeout(initializeConnector, 500);
        });
    </script>
</body>
</html>
